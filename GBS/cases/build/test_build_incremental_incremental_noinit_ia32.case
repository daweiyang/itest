__Issue__:

__Tag__:

__Summary__:test incremental feature with noinit option

__Precondition__

1. Tested Pkgs:
2. Tested Repo: https://download.tz.otcshare.org/snapshots/trunk/common/latest
3. Tested Conf: conf_fixtures/tizendev.cfg

__Steps__

> sudo rm ~/GBS-ROOT/local/repos -rf

> rm build -rf

> mkdir build

> cd build/

> ../tools/create_proj ../specs/sw-tools.spec

> gbs -c ../conf_fixtures/tizendev.cfg build --incremental -A ia32 2>&1 | tee log

> test -n "`grep "generate repositories" log`"

> time1=`find ~/GBS-ROOT/local/repos/ -name "*.rpm" |grep /RPMS/sw-tools |xargs -i stat -c %y {}`

> gbs -c ../conf_fixtures/tizendev.cfg build --incremental --noinit -A ia32 2>&1 | tee log

> time2=`find ~/GBS-ROOT/local/repos/ -name "*.rpm" |grep /RPMS/sw-tools |xargs -i stat -c %y {}`

> test "$time1" != "$time2"

#check build log --no-init, then no generate repositories info
> test -z "`grep "generate repositories" log`"

> test -z "`grep "mount:.*scratch" log`"

> test -z "`grep "skip.*sw-tools" log`"

#check source package whether changed or not
> cd sw-tools && test -n "`git status | grep "working directory clean"`" && cd ..

> test -n "`find ~/GBS-ROOT/local/repos -name "*sw-tools*.rpm"`"

> find ~/GBS-ROOT/local/repos/ -name "*rpm" |xargs -i rpm -qpR {} |grep "rpmlib(ShortCircuited)"
