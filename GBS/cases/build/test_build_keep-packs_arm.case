__Issue__:

__Tag__:

__Summary__:test keep-packs feature

__Precondition__

1. Tested Pkgs:
2. Tested Repo: https://download.tz.otcshare.org/snapshots/trunk/common/latest
3. Tested Conf: conf_fixtures/tizendev.cfg

__Steps__

> sudo rm ~/GBS-ROOT/local/repos -rf

> sudo rm  ~/GBS-ROOT/local/scratch.armv7l.0 -rf

> rm build -rf

> mkdir build

> cd build/

> ../tools/create_proj ../specs/xorg-x11-filesystem.spec

> ../tools/create_proj ../specs/sw-tools.spec

> gbs -c ../conf_fixtures/tizendev.cfg build sw-tools -A armv7l 2>&1 | tee log

> count1="`sudo chroot ~/GBS-ROOT/local/scratch.armv7l.0 rpm -qa | wc -l`"

> gbs -c ../conf_fixtures/tizendev.cfg build xorg-x11-filesystem --keep-packs -A armv7l 2>&1 | tee log

> count2="`sudo chroot ~/GBS-ROOT/local/scratch.armv7l.0 rpm -qa | wc -l`"

> test "$count1" == "$count2"

> test -z "`grep "deleting.*" log`"

> test -n "`grep "init_buildsystem.*keep-packs" log`"

> cd xorg-x11-filesystem && test -n "`git status | grep "working directory clean"`" && cd ..

> test -n "`find ~/GBS-ROOT/local/repos -name "*xorg-x11-filesystem*.rpm"`"

> gbs -c ../conf_fixtures/tizendev.cfg build xorg-x11-filesystem -A armv7l --overwrite 2>&1 | tee log

> count3="`sudo chroot ~/GBS-ROOT/local/scratch.armv7l.0 rpm -qa | wc -l`"

> test "$count2" \> "$count3"

> test -n "`grep "deleting.*" log`"

> test -z "`grep "init_buildsystem.*keep-packs" log`"
